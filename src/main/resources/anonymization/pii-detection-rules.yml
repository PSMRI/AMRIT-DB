# PII Detection Rules for AMRIT Database Anonymization
# Rules are evaluated in priority order (higher first)
# Patterns use Java regex syntax (case-insensitive matching)

rules:
  # === LINKING KEYS (CRITICAL) ===
  - ruleId: BENREGID_LINKING_KEY
    columnNamePattern: "^BeneficiaryRegID$|^BenRegID$"
    tableNamePattern: ".*"
    dataTypePattern: "BIGINT.*"
    piiCategory: LINKING_KEY
    riskLevel: LINKING_KEY
    suggestedRuleId: BENREGID_MAPPING
    rationale: "Cross-database linking key - must preserve relationships"
    priority: 100

  # === PERSONAL IDENTIFIERS (CRITICAL) ===
  - ruleId: FIRST_NAME
    columnNamePattern: ".*[Ff]irst.*[Nn]ame.*|^FirstName$|^fname$"
    tableNamePattern: ".*"
    dataTypePattern: "VARCHAR.*|CHAR.*|TEXT.*"
    piiCategory: PERSONAL_IDENTIFIER
    riskLevel: CRITICAL
    suggestedRuleId: FAKE_FIRST_NAME
    rationale: "Direct personal identifier"
    priority: 90

  - ruleId: LAST_NAME
    columnNamePattern: ".*[Ll]ast.*[Nn]ame.*|^LastName$|^lname$|^Surname$"
    tableNamePattern: ".*"
    dataTypePattern: "VARCHAR.*|CHAR.*|TEXT.*"
    piiCategory: PERSONAL_IDENTIFIER
    riskLevel: CRITICAL
    suggestedRuleId: FAKE_LAST_NAME
    rationale: "Direct personal identifier"
    priority: 90

  - ruleId: MIDDLE_NAME
    columnNamePattern: ".*[Mm]iddle.*[Nn]ame.*|^MiddleName$"
    tableNamePattern: ".*"
    dataTypePattern: "VARCHAR.*|CHAR.*|TEXT.*"
    piiCategory: PERSONAL_IDENTIFIER
    riskLevel: CRITICAL
    suggestedRuleId: FAKE_MIDDLE_NAME
    rationale: "Direct personal identifier"
    priority: 90

  - ruleId: FULL_NAME
    columnNamePattern: ".*[Ff]ull.*[Nn]ame.*|^Name$|^PersonName$"
    tableNamePattern: ".*"
    dataTypePattern: "VARCHAR.*|CHAR.*|TEXT.*"
    piiCategory: PERSONAL_IDENTIFIER
    riskLevel: CRITICAL
    suggestedRuleId: FAKE_FULL_NAME
    rationale: "Direct personal identifier"
    priority: 90

  - ruleId: FATHER_NAME
    columnNamePattern: ".*[Ff]ather.*[Nn]ame.*|^FatherName$"
    tableNamePattern: ".*"
    dataTypePattern: "VARCHAR.*|CHAR.*|TEXT.*"
    piiCategory: PERSONAL_IDENTIFIER
    riskLevel: CRITICAL
    suggestedRuleId: FAKE_FULL_NAME
    rationale: "Family member identifier"
    priority: 85

  - ruleId: MOTHER_NAME
    columnNamePattern: ".*[Mm]other.*[Nn]ame.*|^MotherName$"
    tableNamePattern: ".*"
    dataTypePattern: "VARCHAR.*|CHAR.*|TEXT.*"
    piiCategory: PERSONAL_IDENTIFIER
    riskLevel: CRITICAL
    suggestedRuleId: FAKE_FULL_NAME
    rationale: "Family member identifier"
    priority: 85

  - ruleId: SPOUSE_NAME
    columnNamePattern: ".*[Ss]pouse.*[Nn]ame.*|^SpouseName$"
    tableNamePattern: ".*"
    dataTypePattern: "VARCHAR.*|CHAR.*|TEXT.*"
    piiCategory: PERSONAL_IDENTIFIER
    riskLevel: CRITICAL
    suggestedRuleId: FAKE_FULL_NAME
    rationale: "Family member identifier"
    priority: 85

  - ruleId: GUARDIAN_NAME
    columnNamePattern: ".*[Gg]uardian.*[Nn]ame.*|^GuardianName$"
    tableNamePattern: ".*"
    dataTypePattern: "VARCHAR.*|CHAR.*|TEXT.*"
    piiCategory: PERSONAL_IDENTIFIER
    riskLevel: CRITICAL
    suggestedRuleId: FAKE_FULL_NAME
    rationale: "Guardian identifier"
    priority: 85

  # === CONTACT INFORMATION (CRITICAL) ===
  - ruleId: PHONE_NUMBER
    columnNamePattern: ".*[Pp]hone.*|.*[Mm]obile.*|.*[Cc]ontact.*[Nn]o.*|^PhoneNo$|^MobileNo$"
    tableNamePattern: ".*"
    dataTypePattern: "VARCHAR.*|CHAR.*|BIGINT.*"
    piiCategory: CONTACT
    riskLevel: CRITICAL
    suggestedRuleId: FAKE_PHONE
    rationale: "Direct contact identifier"
    priority: 90

  - ruleId: EMAIL
    columnNamePattern: ".*[Ee]mail.*|^EmailID$|^Email$"
    tableNamePattern: ".*"
    dataTypePattern: "VARCHAR.*|TEXT.*"
    piiCategory: CONTACT
    riskLevel: CRITICAL
    suggestedRuleId: FAKE_EMAIL
    rationale: "Direct contact identifier"
    priority: 90

  - ruleId: ADDRESS
    columnNamePattern: ".*[Aa]ddress.*|^AddressLine.*|^Street.*|^HouseNo$"
    tableNamePattern: ".*"
    dataTypePattern: "VARCHAR.*|TEXT.*"
    piiCategory: CONTACT
    riskLevel: HIGH
    suggestedRuleId: FAKE_ADDRESS
    rationale: "Physical location identifier"
    priority: 80

  - ruleId: PIN_CODE
    columnNamePattern: ".*[Pp]in.*[Cc]ode.*|^PIN$|^Pincode$|^PostalCode$"
    tableNamePattern: ".*"
    dataTypePattern: "VARCHAR.*|INT.*"
    piiCategory: CONTACT
    riskLevel: HIGH
    suggestedRuleId: FAKE_PINCODE
    rationale: "Geographic location identifier"
    priority: 80

  # === GOVERNMENT IDs (CRITICAL) ===
  - ruleId: AADHAAR
    columnNamePattern: ".*[Aa]adh?ar.*|^AadharNo$|^AadhaarNumber$"
    tableNamePattern: ".*"
    dataTypePattern: "VARCHAR.*|BIGINT.*"
    piiCategory: GOVERNMENT_ID
    riskLevel: CRITICAL
    suggestedRuleId: FAKE_AADHAAR
    rationale: "Government-issued unique ID"
    priority: 95

  - ruleId: PAN
    columnNamePattern: ".*[Pp][Aa][Nn].*|^PANNo$|^PANCard$"
    tableNamePattern: ".*"
    dataTypePattern: "VARCHAR.*"
    piiCategory: GOVERNMENT_ID
    riskLevel: CRITICAL
    suggestedRuleId: FAKE_PAN
    rationale: "Tax identification number"
    priority: 95

  - ruleId: VOTER_ID
    columnNamePattern: ".*[Vv]oter.*[Ii][Dd].*|^VoterID$"
    tableNamePattern: ".*"
    dataTypePattern: "VARCHAR.*"
    piiCategory: GOVERNMENT_ID
    riskLevel: CRITICAL
    suggestedRuleId: FAKE_VOTER_ID
    rationale: "Government-issued ID"
    priority: 95

  - ruleId: RATION_CARD
    columnNamePattern: ".*[Rr]ation.*[Cc]ard.*|^RationCardNo$"
    tableNamePattern: ".*"
    dataTypePattern: "VARCHAR.*"
    piiCategory: GOVERNMENT_ID
    riskLevel: HIGH
    suggestedRuleId: FAKE_RATION_CARD
    rationale: "Government-issued card"
    priority: 85

  - ruleId: DRIVING_LICENSE
    columnNamePattern: ".*[Dd]riving.*[Ll]icense.*|^DLNo$"
    tableNamePattern: ".*"
    dataTypePattern: "VARCHAR.*"
    piiCategory: GOVERNMENT_ID
    riskLevel: HIGH
    suggestedRuleId: FAKE_DL
    rationale: "Government-issued license"
    priority: 85

  # === HEALTH IDENTIFIERS (CRITICAL/HIGH) ===
  - ruleId: HEALTH_ID
    columnNamePattern: ".*[Hh]ealth.*[Ii][Dd].*|^HealthID$|^ABHA.*"
    tableNamePattern: ".*"
    dataTypePattern: "VARCHAR.*|BIGINT.*"
    piiCategory: HEALTH_IDENTIFIER
    riskLevel: CRITICAL
    suggestedRuleId: FAKE_HEALTH_ID
    rationale: "National health identifier"
    priority: 95

  - ruleId: MRN
    columnNamePattern: "^MRN$|.*[Mm]edical.*[Rr]ecord.*"
    tableNamePattern: ".*"
    dataTypePattern: "VARCHAR.*|BIGINT.*"
    piiCategory: HEALTH_IDENTIFIER
    riskLevel: HIGH
    suggestedRuleId: FAKE_MRN
    rationale: "Hospital medical record number"
    priority: 85

  # === BIOMETRIC (CRITICAL) ===
  - ruleId: FINGERPRINT
    columnNamePattern: ".*[Ff]inger.*[Pp]rint.*|^Fingerprint$"
    tableNamePattern: ".*"
    dataTypePattern: ".*"
    piiCategory: BIOMETRIC
    riskLevel: CRITICAL
    suggestedRuleId: NULL_OUT
    rationale: "Biometric data"
    priority: 95

  - ruleId: FACE_EMBEDDING
    columnNamePattern: ".*[Ff]ace.*[Ee]mbed.*|^FaceEmbedding$"
    tableNamePattern: ".*"
    dataTypePattern: ".*"
    piiCategory: BIOMETRIC
    riskLevel: CRITICAL
    suggestedRuleId: NULL_OUT
    rationale: "Biometric data"
    priority: 95

  - ruleId: IRIS_DATA
    columnNamePattern: ".*[Ii]ris.*[Dd]ata.*|^IrisData$"
    tableNamePattern: ".*"
    dataTypePattern: ".*"
    piiCategory: BIOMETRIC
    riskLevel: CRITICAL
    suggestedRuleId: NULL_OUT
    rationale: "Biometric data"
    priority: 95

  # === MEDICAL CONDITIONS (MEDIUM) ===
  - ruleId: DIAGNOSIS
    columnNamePattern: ".*[Dd]iagnosis.*|^DiagnosisText$"
    tableNamePattern: ".*"
    dataTypePattern: "VARCHAR.*|TEXT.*"
    piiCategory: MEDICAL_CONDITION
    riskLevel: MEDIUM
    suggestedRuleId: GENERIC_PLACEHOLDER
    rationale: "Medical diagnosis information"
    priority: 70

  - ruleId: CHIEF_COMPLAINT
    columnNamePattern: ".*[Cc]hief.*[Cc]omplaint.*|^ChiefComplaint$"
    tableNamePattern: ".*"
    dataTypePattern: "VARCHAR.*|TEXT.*"
    piiCategory: MEDICAL_CONDITION
    riskLevel: MEDIUM
    suggestedRuleId: GENERIC_PLACEHOLDER
    rationale: "Patient complaint"
    priority: 70

  - ruleId: SYMPTOMS
    columnNamePattern: ".*[Ss]ymptom.*|^Symptoms$"
    tableNamePattern: ".*"
    dataTypePattern: "VARCHAR.*|TEXT.*"
    piiCategory: MEDICAL_CONDITION
    riskLevel: MEDIUM
    suggestedRuleId: GENERIC_PLACEHOLDER
    rationale: "Medical symptoms"
    priority: 70

  - ruleId: PRESCRIPTION
    columnNamePattern: ".*[Pp]rescription.*"
    tableNamePattern: ".*"
    dataTypePattern: "VARCHAR.*|TEXT.*"
    piiCategory: MEDICAL_CONDITION
    riskLevel: MEDIUM
    suggestedRuleId: GENERIC_PLACEHOLDER
    rationale: "Prescription information"
    priority: 70

  # === FREE TEXT (MEDIUM - PII RISK) ===
  - ruleId: CLINICAL_NOTES
    columnNamePattern: ".*[Nn]otes?$|.*[Cc]omment.*|.*[Rr]emarks?$"
    tableNamePattern: ".*"
    dataTypePattern: "TEXT.*|LONGTEXT.*"
    piiCategory: FREE_TEXT_PII_RISK
    riskLevel: MEDIUM
    suggestedRuleId: REDACT_FREE_TEXT
    rationale: "Free-text field may contain PII"
    priority: 65

  # === GEOLOCATION (MEDIUM) ===
  - ruleId: GPS_COORDINATES
    columnNamePattern: ".*[Gg][Pp][Ss].*|.*[Ll]atitude.*|.*[Ll]ongitude.*"
    tableNamePattern: ".*"
    dataTypePattern: ".*"
    piiCategory: GEOLOCATION
    riskLevel: MEDIUM
    suggestedRuleId: RANDOMIZE_GPS
    rationale: "Precise location data"
    priority: 70

  # === DEMOGRAPHIC (LOW - typically retained) ===
  - ruleId: DATE_OF_BIRTH
    columnNamePattern: ".*[Dd][Oo][Bb]$|.*[Dd]ate.*[Oo]f.*[Bb]irth.*|^BirthDate$"
    tableNamePattern: ".*"
    dataTypePattern: "DATE.*|DATETIME.*"
    piiCategory: DEMOGRAPHIC
    riskLevel: MEDIUM
    suggestedRuleId: GENERALIZE_DATE
    rationale: "Birth date can be identifying"
    priority: 75

  - ruleId: AGE
    columnNamePattern: "^Age$|.*[Aa]ge[Ii]n.*"
    tableNamePattern: ".*"
    dataTypePattern: "INT.*|TINYINT.*"
    piiCategory: DEMOGRAPHIC
    riskLevel: LOW
    suggestedRuleId: RETAIN
    rationale: "Age alone is low-risk"
    priority: 30

  - ruleId: GENDER
    columnNamePattern: "^Gender$|^GenderID$|^Sex$"
    tableNamePattern: ".*"
    dataTypePattern: ".*"
    piiCategory: DEMOGRAPHIC
    riskLevel: LOW
    suggestedRuleId: RETAIN
    rationale: "Gender alone is low-risk"
    priority: 30

  # === METADATA (LOW - typically retained) ===
  - ruleId: IP_ADDRESS
    columnNamePattern: ".*[Ii][Pp].*[Aa]ddress.*|^IPAddress$"
    tableNamePattern: ".*"
    dataTypePattern: "VARCHAR.*"
    piiCategory: METADATA
    riskLevel: LOW
    suggestedRuleId: ANONYMIZE_IP
    rationale: "Can be identifying in some contexts"
    priority: 50

  - ruleId: CREATED_BY
    columnNamePattern: "^CreatedBy$|^ModifiedBy$|^UpdatedBy$"
    tableNamePattern: ".*"
    dataTypePattern: "VARCHAR.*|INT.*"
    piiCategory: METADATA
    riskLevel: LOW
    suggestedRuleId: RETAIN
    rationale: "System metadata - typically usernames/IDs"
    priority: 20

  - ruleId: TIMESTAMPS
    columnNamePattern: "^CreatedDate$|^ModifiedDate$|^UpdatedDate$|^Timestamp$"
    tableNamePattern: ".*"
    dataTypePattern: "DATE.*|TIMESTAMP.*"
    piiCategory: METADATA
    riskLevel: NONE
    suggestedRuleId: RETAIN
    rationale: "Timestamps are non-sensitive"
    priority: 10

# Fallback for unmatched columns: mark as UNKNOWN for manual review
defaultClassification:
  piiCategory: UNKNOWN
  riskLevel: NONE
  suggestedRuleId: TBD
  rationale: "No rule matched - requires manual review"
